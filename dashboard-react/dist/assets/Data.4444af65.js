var Z=Object.defineProperty;var ee=(s,n,e)=>n in s?Z(s,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[n]=e;var x=(s,n,e)=>(ee(s,typeof n!="symbol"?n+"":n,e),e);import{r as u,_ as j,u as te,j as o,C as ae,a as S,c as G,b as z,d as ne,e as se,o as re,f as O,g as d,h as H,i as ie,S as oe,k as W,F as ce,A as le,l as ue,m as w,n as q,p as de,B as $,E as he}from"./index.634180f9.js";import{S as J,a as fe,C as me,T as ve,D as ge,b as pe}from"./discuss_card.417a0347.js";var U=function(n){return n?{left:n.offsetLeft,width:n.clientWidth}:null},T=function(n){return n!==void 0?"".concat(n,"px"):void 0};function be(s){var n=s.prefixCls,e=s.containerRef,t=s.value,r=s.getValueIndex,a=s.motionName,i=s.onMotionStart,l=s.onMotionEnd,c=u.exports.useRef(null),b=u.exports.useState(t),f=j(b,2),h=f[0],_=f[1],R=function(B){var y,F=r(B),V=(y=e.current)===null||y===void 0?void 0:y.querySelectorAll(".".concat(n,"-item"))[F];return V},C=u.exports.useState(null),P=j(C,2),m=P[0],E=P[1],k=u.exports.useState(null),N=j(k,2),v=N[0],A=N[1];te(function(){if(h!==t){var g=R(h),B=R(t),y=U(g),F=U(B);_(t),E(y),A(F),g&&B?i():l()}},[t]);var M=function(){return{transform:"translateX(var(--thumb-start-left))",width:"var(--thumb-start-width)"}},I=function(){return{transform:"translateX(var(--thumb-active-left))",width:"var(--thumb-active-width)"}},L=function(){E(null),A(null),l()};return!m||!v?null:o(ae,{visible:!0,motionName:a,motionAppear:!0,onAppearStart:M,onAppearActive:I,onAppearEnd:L,children:function(g,B){var y=g.className,F=g.style,V=S(S({},F),{},{"--thumb-start-left":T(m==null?void 0:m.left),"--thumb-start-width":T(m==null?void 0:m.width),"--thumb-active-left":T(v==null?void 0:v.left),"--thumb-active-width":T(v==null?void 0:v.width)}),p={ref:G(c,B),style:V,className:z("".concat(n,"-thumb"),y)};return o("div",{...S({},p)})}})}var Ce=["prefixCls","direction","options","disabled","defaultValue","value","onChange","className","motionName"];function Se(s){if(typeof s.title<"u")return s.title;if(H(s.label)!=="object"){var n;return(n=s.label)===null||n===void 0?void 0:n.toString()}}function _e(s){return s.map(function(n){if(H(n)==="object"&&n!==null){var e=Se(n);return S(S({},n),{},{title:e})}return{label:n==null?void 0:n.toString(),title:n==null?void 0:n.toString(),value:n}})}var ye=function(n){var e=n.prefixCls,t=n.className,r=n.disabled,a=n.checked,i=n.label,l=n.title,c=n.value,b=n.onChange,f=function(_){r||b(_,c)};return d("label",{className:z(t,O({},"".concat(e,"-item-disabled"),r)),children:[o("input",{className:"".concat(e,"-item-input"),type:"radio",disabled:r,checked:a,onChange:f}),o("div",{className:"".concat(e,"-item-label"),title:l,children:i})]})},K=u.exports.forwardRef(function(s,n){var e,t,r=s.prefixCls,a=r===void 0?"rc-segmented":r,i=s.direction,l=s.options,c=s.disabled,b=s.defaultValue,f=s.value,h=s.onChange,_=s.className,R=_===void 0?"":_,C=s.motionName,P=C===void 0?"thumb-motion":C,m=ne(s,Ce),E=u.exports.useRef(null),k=u.exports.useMemo(function(){return G(E,n)},[E,n]),N=u.exports.useMemo(function(){return _e(l)},[l]),v=se((e=N[0])===null||e===void 0?void 0:e.value,{value:f,defaultValue:b}),A=j(v,2),M=A[0],I=A[1],L=u.exports.useState(!1),g=j(L,2),B=g[0],y=g[1],F=function(X,D){c||(I(D),h==null||h(D))},V=re(m,["children"]);return o("div",{...S(S({},V),{},{className:z(a,(t={},O(t,"".concat(a,"-rtl"),i==="rtl"),O(t,"".concat(a,"-disabled"),c),t),R),ref:k}),children:d("div",{className:"".concat(a,"-group"),children:[o(be,{prefixCls:a,value:M,containerRef:E,motionName:"".concat(a,"-").concat(P),getValueIndex:function(X){return N.findIndex(function(D){return D.value===X})},onMotionStart:function(){y(!0)},onMotionEnd:function(){y(!1)}}),N.map(function(p){return o(ye,{...S(S({key:p.value,prefixCls:a,className:z(p.className,"".concat(a,"-item"),O({},"".concat(a,"-item-selected"),p.value===M&&!B)),checked:p.value===M,onChange:F},p),{},{disabled:!!c||!!p.disabled})})})]})})});K.displayName="Segmented";K.defaultProps={options:[]};var Y=globalThis&&globalThis.__rest||function(s,n){var e={};for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&n.indexOf(t)<0&&(e[t]=s[t]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(s);r<t.length;r++)n.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(s,t[r])&&(e[t[r]]=s[t[r]]);return e};function xe(s){return H(s)==="object"&&!!(s!=null&&s.icon)}var ke=u.exports.forwardRef(function(s,n){var e,t=s.prefixCls,r=s.className,a=s.block,i=s.options,l=i===void 0?[]:i,c=s.size,b=c===void 0?"middle":c,f=Y(s,["prefixCls","className","block","options","size"]),h=u.exports.useContext(ie),_=h.getPrefixCls,R=h.direction,C=_("segmented",t),P=u.exports.useContext(oe),m=b||P,E=u.exports.useMemo(function(){return l.map(function(k){if(xe(k)){var N=k.icon,v=k.label,A=Y(k,["icon","label"]);return W(W({},A),{label:d(ce,{children:[o("span",{className:"".concat(C,"-item-icon"),children:N}),v&&o("span",{children:v})]})})}return k})},[l,C]);return o(K,{...f,className:z(r,(e={},O(e,"".concat(C,"-block"),a),O(e,"".concat(C,"-sm"),m==="small"),O(e,"".concat(C,"-lg"),m==="large"),e)),options:E,ref:n,prefixCls:C,direction:R})});const we=ke;var Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const Ne=Ee;var Q=function(n,e){return o(le,{...S(S({},n),{},{ref:e,icon:Ne})})};Q.displayName="LockOutlined";const Be=u.exports.forwardRef(Q);function Ae(s){var e;const{d:n}=s;return d(ue,{bodyStyle:{display:"flex",placeItems:"flex-start"},children:[o("div",{style:{width:"10vh",height:"10vh",backgroundSize:"100%",backgroundPosition:"center",borderRadius:"50%",backgroundColor:"gray",border:"2px solid lightgray",backgroundImage:"url("+((e=n.headImg)==null?void 0:e.toString())+")"}}),d("div",{style:{marginLeft:"1vh"},children:[d("p",{children:["id\uFF1A",n.userid.toString()]}),d("p",{children:["\u7528\u6237\u6635\u79F0\uFF1A",n.username.toString()]}),d("p",{children:["\u6027\u522B\uFF1A",n.gender.toString()]}),d("p",{children:["\u751F\u65E5\uFF1A",n.birthday.toString()]})]})]})}class Pe extends u.exports.Component{constructor(){super(...arguments);x(this,"state",{url_cfg:{},_switch:"share",data:[],chose_all:!1,chose_count:0});x(this,"request",async(e,t)=>await w.fetch(e,{method:"POST",body:w.Body.json({type:t})}).then(r=>(console.log(r.data.data),r.data.errCode==="OK-100"?r.data.data.map(a=>({...a,isChosen:!1})):[])).catch(r=>r));x(this,"delete",async e=>{if(await q("\u6B64\u64CD\u4F5C\u4E0D\u53EF\u9006\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F",{title:"\u8B66\u544A",type:"warning"})){const{url_cfg:t}=this.state,[r,a]=[{},this];let i="";switch(this.state._switch){case"share":i=e.sid;break;case"comment":i=e.cid;break;case"topic":i=e.tid;break;case"discuss":i=e.did;break;case"user":i=e.userid;break}w.fetch(t.server_url+t.api.delete_complete,{method:"POST",body:w.Body.json({id_in:i})}).then(async l=>{l.data.errCode==="OK-200"&&(r.data=await a.request(t.server_url+t.api.get_data,a.state._switch).then(c=>c),a.setState({data:r.data}))})}});x(this,"lock",async e=>{if(await q("\u662F\u5426\u7EE7\u7EED",{title:"\u786E\u8BA4",type:"info"})){const{url_cfg:t}=this.state,[r,a]=[this,{}];let i="";switch(this.state._switch){case"share":i=e.sid;break;case"comment":i=e.cid;break;case"topic":i=e.tid;break;case"discuss":i=e.did;break;case"user":i=e.userid;break}const l=i.at(0),c=(b,f)=>{w.fetch(b,{method:"POST",body:f}).then(async h=>{console.log(h),h.data.errCode==="OK-200"&&(a.data=await r.request(t.server_url+t.api.get_data,r.state._switch).then(_=>_),r.setState({data:a.data}))})};switch(l){case"s":case"c":case"t":case"d":console.log("common"),c(t.server_url+t.api.lock_content,w.Body.json({data:i}));break;case"u":console.log("user"),c(t.server_url+t.api.lock_user,w.Body.json({userid:i}));break}}});x(this,"onSegmentChange",async e=>{let t="";switch(e){case"\u5E16\u5B50":t="share";break;case"\u8BC4\u8BBA":t="comment";break;case"\u4E3B\u9898":t="topic";break;case"\u8BA8\u8BBA":t="discuss";break;case"\u7528\u6237":t="user";break}const r=await this.request(this.state.url_cfg.server_url+this.state.url_cfg.api.get_data,t).then(a=>a);this.setState({_switch:t,data:r,chose_all:!1,chose_count:0})});x(this,"init",()=>{const e=this,t={};de("read_cfg").then(async r=>{t.url_cfg=JSON.parse(r),t.data=await e.request(t.url_cfg.server_url+t.url_cfg.api.get_data,e.state._switch).then(a=>a),console.log(t),e.setState({...t}),console.log("state:",e.state)})});x(this,"switchChosen",e=>{const{data:t}=this.state;let{chose_count:r}=this.state;console.log("find:",t.indexOf(e)),t[t.indexOf(e)].isChosen=!t[t.indexOf(e)].isChosen,this.setState({data:t,chose_count:r+=t[t.indexOf(e)].isChosen?1:-1,chose_all:r===t.length})});x(this,"selectAll",()=>{const{data:e}=this.state,r=e.filter(i=>i.isChosen).length===e.length;console.log(r);const a=e.map(i=>({...i,isChosen:!r}));this.setState({data:a,chose_all:!r,chose_count:r?0:a.length})});x(this,"delSelected",async()=>{if(await q("\u6B64\u64CD\u4F5C\u4E0D\u53EF\u9006\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F",{type:"warning",title:"\u8B66\u544A"})){const{data:e,_switch:t,url_cfg:r}=this.state;for(let a=e.length-1;a>=0;a--){let i;const[l,c]=[{},this];if(e[a].isChosen){switch(t){case"share":i=e[a].sid;break;case"comment":i=e[a].cid;break;case"topic":i=e[a].tid;break;case"discuss":i=e[a].did;break;case"user":i=e[a].userid;break}await w.fetch(r.server_url+r.api.delete_complete,{method:"POST",body:w.Body.json({id_in:i})}).then(async b=>{b.data.errCode==="OK-200"&&a===0&&(l.data=await c.request(r.server_url+r.api.get_data,t).then(f=>f),c.setState({data:l.data}))})}}}})}componentDidMount(){this.init()}render(){const{data:e,chose_all:t,chose_count:r}=this.state;return d("div",{children:[d(J,{children:[o(we,{defaultValue:"\u5E16\u5B50",options:["\u5E16\u5B50","\u8BC4\u8BBA","\u4E3B\u9898","\u8BA8\u8BBA","\u7528\u6237"],onChange:a=>this.onSegmentChange(a)}),o($,{onClick:this.selectAll,children:t?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"}),r>0&&o($,{onClick:this.delSelected,type:"primary",danger:!0,children:"\u5220\u9664"})]}),d("div",{style:{marginTop:"3vh",height:"90vh",overflowY:"auto"},children:[e.length===0&&o(he,{description:"\u597D\u50CF\u6CA1\u6709\u6570\u636E\u6B38"}),o("div",{}),e.map((a,i)=>d("div",{style:{minHeight:"12vh",marginBottom:"1vh"},children:[a.sid&&!a.cid&&o(fe,{d:a}),a.sid&&a.cid&&o(me,{d:a}),a.tid&&!a.did&&o(ve,{d:a}),a.tid&&a.did&&o(ge,{d:a}),a.userid&&o(Ae,{d:a}),d(J,{style:{marginTop:"1vh"},size:"middle",children:[o(pe,{checked:a.isChosen,onChange:()=>this.switchChosen(a)}),a.isDel&&o(Be,{style:{width:"5vh",height:"5vh",fontSize:"5vh"}}),o($,{onClick:()=>this.lock(a),children:a.isDel?"\u89E3\u9501":"\u9501\u5B9A"}),a.userid&&a.isBan&&o($,{children:"\u89E3\u5C01"}),o($,{type:"primary",danger:!0,onClick:()=>this.delete(a),children:"\u5220\u9664"})]})]},i))]})]})}}export{Pe as default};
